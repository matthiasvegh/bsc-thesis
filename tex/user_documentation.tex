\chapter{User Documentation}
\label{chapter:UserDoc}

\newread\ownread
\newcommand{\piprequirements}[1]{
	\IfFileExists{#1}{
		\openin\ownread=#1
		\begin{itemize}
			\loop\unless\ifeof\ownread
			\read\ownread to \requirement
			\ifeof\ownread
			\else
				\item \requirement \cite{\requirement}
			\fi
			\repeat
		\end{itemize}
		\closein\ownread
	}{File not found}
}

This chapter describes how to use the various components included in this
thesis.

\section{Building and Installation}
\subsection{Prerequisites}
\subsubsection{Python packages required}
To build, install and test the components of this project, the following
dependencies are required:
\piprequirements{requirements.txt}

\subsubsection{\LaTeX{} packages required}
\begin{itemize}
	\item Tikz-UML \cite{tikzuml}
\end{itemize}

\subsection{Building}
Once the repository is cloned, setup a build directory and invoke meson.
\begin{lstlisting}[language=bash]
cd /path/to/repository
mkdir build
cd build
meson ..
cd ..
\end{lstlisting}

The default build target will build the project, along with this thesis.
\begin{lstlisting}[language=bash]
ninja -C build
\end{lstlisting}

To run the tests, use \lstinline|ninja -C build test|.

\subsection{Installing}
Add \lstinline|suggest_names| to your \lstinline|PATH|.
\begin{lstlisting}[language=bash]
$ export PATH=/path/to/repository/suggest_names:$PATH
\end{lstlisting}


\section{Using}
\subsection{Generating the Variable Database}
Before any variable suggestions can be made, the source-code must be indexed.
This is achieved with a clang-plugin, that collects all variable occurences,
and information about them, such as type and name.

\subsubsection{Clang Invocation}
To generate a database for a given source file, run clang as follows:

\begin{lstlisting}
clang++ \
	-fplugin=/path/to/repository/build/libdump_names.so \
	-Xclang \
	-plugin-arg-dump-names \
	-Xclang \
	output-file \
	-Xclang \
	-plugin-arg-dump-names \
	-Xclang \
	/path/for/database \
	all... \
	other... \
	args... \
	/path/to/source.cpp
\end{lstlisting}

\subsection{Using the Vim Plugin}
The Vim \cite{vim} plugin can be added to your \lstinline|.vimrc| by adding the
following two lines:

\begin{lstlisting}
set rtp+=/path/to/repository/vim
helptags /path/to/repository/vim/doc
\end{lstlisting}

Following this, the documentation of the Vim plugin is available through the
usual commands of Vim, such as \lstinline|:help|.

The output of querying the help for \lstinline|:help suggest-names.txt| is as
follows:
\lstinputlisting[language=vimdoc]{vim-doc.txt}
